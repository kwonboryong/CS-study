
# 📌 메모리 관리 전략

<br/>

## 목차
1. [논리 메모리와 물리 메모리](#-논리-메모리와-물리-메모리)
2. [연속 메모리 할당](#-연속-메모리-할당(contiguous-allocation))
3. [비연속 메모리 할당](#-비연속-메모리-할당)

<br/><br/>

## ✅ 논리 메모리와 물리 메모리
- CPU가 프로세스를 처리할 때 보는 주소 값과 실제 메모리의 주소 값은 다르다. 

<br/>

### ☑️ 논리 메모리 

- **논리 메모리 영역(logical memory address space)** <br/>
: 프로세스가 보는 메모리 영역
  - 가상 메모리 영역(virtual memory address space)

<br/>

- **논리 주소(logical address)** <br/>
: CPU가 프로세스를 실행하며 보는 주소 값
  - 가상 주소(virtual address)

<br/><br/>

### ☑️ 물리 메모리
- **물리 메모리 영역(physical memory address space)** <br/>
: 실제로 사용되는 메모리 영역(RAM)

<br/>

- **물리 주소(physical address)** <br/>
: 실제 메모리에서 사용되는 주소

<br/><br/>

### ☑️ 메모리 관리 장치(MMU, Memory Management Unit)
: CPU가 프로세스를 실행할 때 사용하는 주소 값과 실제 주소 값이 다르므로 **논리 주소를 물리 주소로 변환해주는 하드웨어 장치**
- CPU에 위치
- CPU에서 메모리에 접근하기 전에 MMU를 거쳐 논리 주소에 해당하는 물리 주소를 얻는다.
- MMU는 보호해야 하는 메모리 영역에 대한 접근을 제한해 메모리를 보호하는 역할을 한다.

<br/>

![](https://thebook.io/img/080367/049.jpg) <br/>
출처: [메모리 관리 장치](https://thebook.io/img/080367/049.jpg)

<br/><br/>
<br/>

## ✅ 연속 메모리 할당(contiguous allocation)
: 멀티 프로세스 환경에서 여러 프로세스를 메모리에 연속적으로 로드하는 방법
- 연속 메모리 할당 방법은 고정 분할 방식과 가변 분할 방식이 있다.

<br/>

### ☑️ 고정 분할 방식
: 메모리 영역을 분할한 뒤 각 영역에 프로세스를 할당하는 방식
- 분할된 영역의 크기는 서로 다를 수 있으며, 분할된 크기는 고정된다. 
- 단점
  1. 메모리에 올릴 수 있는 프로세스 수와 각 프로세스 크기가 제한된다. 
  2. 단편화(fragmentation) 문제가 발생할 수 있다.
    * **외부 단편화(external fragmentation)** <br/>
    : 메모리 공간이 작은 조각들로 나뉘어, 충분한 메모리 공간이 있더라도 큰 프로세스가 들어갈 수 없게 되는 현상
    * **내부 단편화(internal fragmentation)** <br/>
    : 프로세스가 할당된 메모리 공간보다 작은 메모리를 사용하여, 사용하지 않는 공간이 낭비되는 현상
    
      * **외부 단편화 문제를 해결하는 방법** <br/>
👉 메모리 압축(memory compaction)(= 메모리 집약) <br/>
: 프로세스가 사용 중인 메모리 공간을 재배치해서 흩어져 있는 가용 메모리 공간을 하나로 합치는 것

<br/>

![](https://thebook.io/img/080367/050.jpg) <br/>
출처: [고정 분할 방식](https://thebook.io/img/080367/050.jpg)

<br/><br/>

### ☑️ 가변 분할 방식
: 할당할 프로세스의 크기에 따라 메모리 공간을 분할하는 방식
- 메모리 할당 알고리즘을 이용하여 가용 메모리 공간에서 프로세스가 로드될 수 있는 메모리 공간을 찾는다. 

<br/>

#### ⏩ 메모리 할당 알고리즘
1. **최초 적합(first-fit)** <br/>
: 가용 메모리 공간에서 **프로세스 크기만큼** 비어 있는 메모리 공간을 찾아 차례대로 프로세스를 로드하는 방식

2. **최적 적합(best-fit)** <br/>
: **할당하려는 프로세스 크기보다 큰 가용 메모리 공간 중에서 가장 작은 공간에** 프로세스를 할당하는 방식
   - 가용 메모리 공간을 모두 탐색해야 한다.

3. **최악 적합(worst-fit)** <br/>
: **할당하려는 프로세스 크기보다 큰 가용 메모리 공간 중에서 가장 큰 공간에** 프로세스를 할당하는 방식
   - 가용 메모리 공간을 모두 탐색해야 한다.

<br/><br/>
<br/>

## ✅ 비연속 메모리 할당
: 프로세스의 메모리 영역을 나눠서 메모리 공간에 저장하는 방법

<br/>

### ☑️ 페이징(paging)
: 프로세스의 논리 메모리와 물리 메모리 영역을 같은 크기의 페이지(page)와 프레임(frame)으로 나누어 관리하는 방식
- 페이지와 프레임에 각각 번호를 할당하여 프로세스의 페이지와 메모리의 프레임을 매핑한다.

<br/>

![](https://thebook.io/img/080367/054.jpg) <br/>
출처: [페이징](https://thebook.io/img/080367/054.jpg)

<br/>

- **페이지** <br/>
: 프로세스의 논리 메모리 영역을 일정한 크기로 나눈 단위
  - 페이지와 프레임 크기는 동일하다. 
  - 각 페이지는 물리 메모리의 프레임에 페이지 테이블을 통해 매핑됩니다. 
  - 페이지와 프레임에는 각각 번호를 할당해 프로세스의 페이지와 메모리의 프레임을 매핑한다.

<br/>

- **프레임** <br/>
: 물리 메모리(RAM)를 페이지와 같은 크기로 나눈 단위

<br/>

- **페이지 테이블(page table)** <br/>
: 페이지와 프레임을 매핑하는 데 사용
  - 프로세스의 페이지 정보와 페이지에 매핑하는 프레임의 주소 값을 저장한다. 
  - 각 프로세스의 PCB에 저장된다.

<br/>

- 장점: 페이지를 물리 메모리에 연속적으로 할당할 필요가 없어서 외부 단편화 문제를 해결
- 단점:
  1. 프로세스의 마지막 페이지가 페이지 크기보다 작을 경우, 내부 단편화 발생 가능
  2. 페이지 테이블을 저장할 추가 메모리 공간이 필요

<br/>

#### ⏩ 페이징 기법
- **계층적 페이징(hierarchical paging)** <br/>
: 페이지 테이블을 다시 페이지로 나눠 페이지 테이블 자체를 페이징하는 방식
  - 멀티 레벨 페이징(multi-level paging)이라고도 한다.

- **해시 페이지 테이블(hashed page table)** <br/>
: 해시 테이블의 각 항목에 저장된 연결 리스트에 페이지 번호를 해싱(hashing)한 뒤에 첫 번째 요소와 가상 페이지 번호를 비교하는 방식

- **역 페이지 테이블(inverted page table)** <br/>
: 프레임을 이용해 페이지를 찾는 방식
  - 페이지로 프레임을 찾는 기존 방식과 반대

<br/><br/>

### ☑️ 세그먼테이션(segmentation)
: 프로세스의 메모리 영역을 논리적 단위인 세그먼트로 분할하여 메모리를 할당하는 방식
- 논리적 단위는 파일 내 함수 단위나 프로세스의 스택, 힙과 같은 영역을 의미하기도 한다.
- 세그먼테이션 테이블(segment table)을 사용해 세그먼트의 논리 주소를 물리 주소로 매핑한다. 

<br/>

![](https://thebook.io/img/080367/055.jpg) <br/>
출처: [세그먼테이션](https://thebook.io/img/080367/055.jpg)

<br/>

- **세그먼트** <br/>
: 프로세스의 논리적 단위로 나눈 메모리 영역

<br/>

- **세그먼테이션 테이블** <br/>
: 세그먼트 번호를 인덱스로 사용하며, 각 세그먼트의 시작 주소(base)와 크기(limit)를 저장하여 논리 주소를 물리 주소로 변환하는 데 사용
  - 장점: 프로세스를 논리적 단위로 나눠 처리하므로 단위별 메모리 보호가 쉽습니다.
  - 단점:
    1. 세그먼트 크기가 일정하지 않아서 메모리 할당과 해제 과정에서 외부 단편화 발생
    2. 스택 오버플로가 발생하면 다른 프로세스와 메모리 영역이 겹칠 수 있고, 스왑 아웃이 필요할 수 있음

<br/><br/>
